# Auto-merge Dependabot patch PRs when labeled
# IMPORTANT: This workflow requires that you allow GitHub Actions to merge pull requests
# in the repository settings: Settings > Actions > General > Workflow permissions > "Allow GitHub Actions to create and approve pull requests"

name: Auto Merge Dependabot Patch PRs

on:
  pull_request_target:
    branches:
      - main
    types:
      - labeled

jobs:
  merge-patch-prs:
    runs-on: ubuntu-latest
    steps:
      - name: Merge Dependabot Patch PRs
        run: |
          for pr_number in $(gh pr list --state open --label "dependencies" --json number | jq -r '.[] | .number'); do
            gh pr merge --auto --squash --delete-branch $pr_number
          done
